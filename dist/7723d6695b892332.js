import*as THREE from"three";import init from"./init";import"./style.css";const{sizes,camera,scene,canvas,renderer}=init();camera.position.z=3;const geometry=new THREE.BoxGeometry(.5,.5,.5),material=new THREE.MeshBasicMaterial({color:"green",wireframe:!0}),cube=new THREE.Mesh(geometry,material);scene.add(cube);const clock=new THREE.Clock,stripWidth=30;let stripHeight=.1;const maxNarrow=3.5;let currNarrow=2;const createStrip=e=>{const t=new THREE.PlaneGeometry(30,stripHeight),r=new THREE.MeshBasicMaterial({color:"brown"}),o=new THREE.Mesh(t,r);return o.position.y=e,o.position.x=-Math.PI/2,o},topStrip=createStrip(1),bottomStrip=createStrip(-1);scene.add(topStrip,bottomStrip);const colors=["red","cyan","blue","yellow","purple","brown","cyan","white","orange"];let scoreCatched=0;const raycaster=new THREE.Raycaster,mouse=new THREE.Vector2,handleClick=()=>{window.addEventListener("click",(e=>{mouse.x=e.clientX/sizes.width*2-1,mouse.y=-e.clientY/sizes.height*2+1,raycaster.setFromCamera(mouse,camera),raycaster.intersectObject(cube).length>0&&cube.position.y<topStrip.position.y+stripHeight/2&&cube.position.y>bottomStrip.position.y-stripHeight/2?(alert("Поймал!"),scoreCatched++,document.getElementById("score").innerText=`Поймано: ${scoreCatched}`,cube.material.color.set(colors[Math.floor(Math.random()*colors.length)]),currNarrow<3.5&&(currNarrow+=-.1,topStrip.position.y=currNarrow/2,bottomStrip.position.y=-currNarrow/2)):(alert("Мимо!"),location.reload())}))};window.addEventListener("click",(e=>{mouse.x=e.clientX/sizes.width*2-1,mouse.y=-e.clientY/sizes.height*2+1,raycaster.setFromCamera(mouse,camera),raycaster.intersectObject(cube).length>0&&cube.position.y<topStrip.position.y+stripHeight/2&&cube.position.y>bottomStrip.position.y-stripHeight/2?(alert("Поймал!"),scoreCatched++,document.getElementById("score").innerText=`Поймано: ${scoreCatched}`,cube.material.color.set(colors[Math.floor(Math.random()*colors.length)]),currNarrow<3.5&&(currNarrow+=-.1,topStrip.position.y=currNarrow/2,bottomStrip.position.y=-currNarrow/2)):(alert("Мимо!"),location.reload())}));const tick=()=>{renderer.render(scene,camera);const e=clock.getElapsedTime();cube.position.x=3*Math.cos(e),cube.position.y=2*Math.sin(e),window.requestAnimationFrame(tick)};tick(),window.addEventListener("resize",(()=>{sizes.width=window.innerWidth,sizes.height=window.innerHeight,camera.aspect=sizes.width/sizes.height,camera.updateProjectionMatrix(),renderer.setSize(sizes.width,sizes.height),renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),renderer.render(scene,camera)}));